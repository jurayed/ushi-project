<!DOCTYPE html>
<html>
<body>
    <h2>–¢–µ—Å—Ç API –£—à–∏</h2>
    
    <button onclick="testHealth()">Test Health</button>
    <button onclick="testRegister()">Test Register</button>
    <button onclick="testUsers()">Test Users</button>
    
    <div id="result"></div>

    <script>
        async function testHealth() {
            const response = await fetch('http://localhost:3000/api/health');
            const data = await response.json();
            document.getElementById('result').innerHTML = JSON.stringify(data, null, 2);
        }

        async function testRegister() {
            const response = await fetch('http://localhost:3000/api/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    username: 'testuser',
                    email: 'test@example.com',
                    password: '123456'
                })
            });
            const data = await response.json();
            document.getElementById('result').innerHTML = JSON.stringify(data, null, 2);
        }

        async function testUsers() {
            const response = await fetch('http://localhost:3000/api/users');
            const data = await response.json();
            document.getElementById('result').innerHTML = JSON.stringify(data, null, 2);
        }
    </script>
	
	<div style="margin: 20px; padding: 20px; border: 1px solid #ccc;">
		<h3>–¢–µ—Å—Ç —á–∞—Ç–∞ —Å –ò–ò</h3>
		<div>
			<label>–ü—Å–∏—Ö–æ—Ç–∏–ø:</label>
			<select id="psychotype">
				<option value="empath">–≠–º–ø–∞—Ç</option>
				<option value="optimist">–û–ø—Ç–∏–º–∏—Å—Ç</option>
				<option value="rational">–†–∞—Ü–∏–æ–Ω–∞–ª–∏—Å—Ç</option>
			</select>
		</div>
		<div>
			<label>–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
			<input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="width: 300px;">
		</div>
		<button onclick="testAIChat()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ò–ò</button>
		
		<div id="chatResult" style="margin-top: 10px; padding: 10px; background: #f5f5f5; min-height: 50px;">
		</div>
	</div>
	<script>
async function testAIChat() {
    const psychotype = document.getElementById('psychotype').value;
    const message = document.getElementById('messageInput').value;
    
    if (!message) {
        alert('–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ');
        return;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
    document.getElementById('chatResult').innerHTML = '‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å...';
    
    try {
        const response = await fetch('http://localhost:3000/api/chat/ai', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json' 
            },
            body: JSON.stringify({
                message: message,
                psychotype: psychotype
            })
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            document.getElementById('chatResult').innerHTML = 
                `<strong>${data.psychotype}:</strong> ${data.response}`;
        } else {
            document.getElementById('chatResult').innerHTML = 
                `‚ùå –û—à–∏–±–∫–∞: ${data.error}`;
        }
            
    } catch (error) {
        console.error('Full error:', error);
        document.getElementById('chatResult').innerHTML = 
            `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}<br>
             üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –±—Ä–∞—É–∑–µ—Ä–∞`;
    }
}
</script>

</body>
</html>